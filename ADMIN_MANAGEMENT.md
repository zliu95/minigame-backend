# ç®¡ç†å‘˜è´¦æˆ·ç®¡ç†æŒ‡å—

æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•åˆ›å»ºã€ç®¡ç†å’Œç»´æŠ¤ç®¡ç†å‘˜è´¦æˆ·ã€‚

## ğŸ“‹ ç›®å½•

- [å¿«é€Ÿåˆ›å»ºç®¡ç†å‘˜](#å¿«é€Ÿåˆ›å»ºç®¡ç†å‘˜)
- [ç®¡ç†å‘˜å‘½ä»¤](#ç®¡ç†å‘˜å‘½ä»¤)
- [æ–¹æ³•å¯¹æ¯”](#æ–¹æ³•å¯¹æ¯”)
- [å®‰å…¨å»ºè®®](#å®‰å…¨å»ºè®®)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## å¿«é€Ÿåˆ›å»ºç®¡ç†å‘˜

### æ–¹æ³• 1ï¼šä½¿ç”¨ç§å­è„šæœ¬ï¼ˆæœ€å¿«ï¼‰

```bash
npm run db:seed
```

**åˆ›å»ºçš„è´¦æˆ·ï¼š**
- ç”¨æˆ·å: `admin`
- å¯†ç : `admin123`

**æ³¨æ„ï¼š** è¿™ä¸ªæ–¹æ³•è¿˜ä¼šåˆ›å»ºç¤ºä¾‹æ¸¸æˆå’Œç©å®¶æ•°æ®ï¼Œé€‚åˆå¼€å‘å’Œæµ‹è¯•ã€‚

### æ–¹æ³• 2ï¼šäº¤äº’å¼åˆ›å»ºï¼ˆæ¨èï¼‰

```bash
npm run admin:create
```

**äº¤äº’å¼æç¤ºï¼š**
```
ğŸ‘¤ åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

è¯·è¾“å…¥ç”¨æˆ·å: myusername
è¯·è¾“å…¥å¯†ç ï¼ˆè‡³å°‘ 6 ä¸ªå­—ç¬¦ï¼‰: ******
è¯·å†æ¬¡è¾“å…¥å¯†ç : ******

âœ… ç®¡ç†å‘˜è´¦æˆ·åˆ›å»ºæˆåŠŸï¼
```

**ä¼˜ç‚¹ï¼š**
- è‡ªå®šä¹‰ç”¨æˆ·åå’Œå¯†ç 
- å¯†ç è¾“å…¥æ—¶éšè—æ˜¾ç¤º
- è‡ªåŠ¨æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
- å¯†ç å¼ºåº¦éªŒè¯

---

## ç®¡ç†å‘˜å‘½ä»¤

### åˆ›å»ºç®¡ç†å‘˜

```bash
# äº¤äº’å¼åˆ›å»º
npm run admin:create

# ç‰¹ç‚¹ï¼š
# - è‡ªå®šä¹‰ç”¨æˆ·åå’Œå¯†ç 
# - å¯†ç éšè—è¾“å…¥
# - è‡ªåŠ¨éªŒè¯
```

### åˆ—å‡ºæ‰€æœ‰ç®¡ç†å‘˜

```bash
npm run admin:list
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
ğŸ‘¥ ç®¡ç†å‘˜è´¦æˆ·åˆ—è¡¨
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

æ‰¾åˆ° 2 ä¸ªç®¡ç†å‘˜è´¦æˆ·ï¼š

1. admin
   ID: clxxx...
   åˆ›å»ºæ—¶é—´: 2024-11-16 10:30:00
   æ›´æ–°æ—¶é—´: 2024-11-16 10:30:00

2. superadmin
   ID: clyyy...
   åˆ›å»ºæ—¶é—´: 2024-11-16 11:00:00
   æ›´æ–°æ—¶é—´: 2024-11-16 11:00:00
```

### ä¿®æ”¹å¯†ç 

```bash
# äº¤äº’å¼é€‰æ‹©ç”¨æˆ·
npm run admin:password

# æˆ–ç›´æ¥æŒ‡å®šç”¨æˆ·å
npm run admin:password admin
```

**äº¤äº’æµç¨‹ï¼š**
```
ğŸ”‘ ä¿®æ”¹ç®¡ç†å‘˜å¯†ç 
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ç°æœ‰ç®¡ç†å‘˜:
  1. admin
  2. superadmin

è¯·è¾“å…¥è¦ä¿®æ”¹å¯†ç çš„ç”¨æˆ·å: admin
âœ… æ‰¾åˆ°ç”¨æˆ·: admin

è¯·è¾“å…¥æ–°å¯†ç ï¼ˆè‡³å°‘ 6 ä¸ªå­—ç¬¦ï¼‰: ******
è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç : ******

âœ… å¯†ç ä¿®æ”¹æˆåŠŸï¼
```

### æŸ¥çœ‹æ•°æ®åº“

```bash
# æ‰“å¼€ Prisma Studioï¼ˆå¯è§†åŒ–ç•Œé¢ï¼‰
npx prisma studio

# åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ http://localhost:5555
# å¯ä»¥æŸ¥çœ‹ã€ç¼–è¾‘ã€åˆ é™¤ç®¡ç†å‘˜
```

---

## æ–¹æ³•å¯¹æ¯”

| æ–¹æ³• | å‘½ä»¤ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|------|----------|
| **ç§å­è„šæœ¬** | `npm run db:seed` | æœ€å¿«ï¼Œä¸€é”®å®Œæˆ | å›ºå®šè´¦å·å¯†ç  | å¼€å‘ã€æµ‹è¯• |
| **äº¤äº’å¼åˆ›å»º** | `npm run admin:create` | è‡ªå®šä¹‰ï¼Œå®‰å…¨ | éœ€è¦æ‰‹åŠ¨è¾“å…¥ | ç”Ÿäº§ç¯å¢ƒ |
| **Prisma Studio** | `npx prisma studio` | å¯è§†åŒ–ï¼Œç›´è§‚ | éœ€è¦æ‰‹åŠ¨åŠ å¯†å¯†ç  | æ•°æ®åº“ç®¡ç† |
| **ç›´æ¥ SQL** | `psql` æˆ–æ§åˆ¶å° | çµæ´» | å¤æ‚ï¼Œæ˜“å‡ºé”™ | é«˜çº§ç”¨æˆ· |

---

## ä½¿ç”¨ Prisma Studio ç®¡ç†

### 1. å¯åŠ¨ Prisma Studio

```bash
npx prisma studio
```

æµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€ http://localhost:5555

### 2. æŸ¥çœ‹ç®¡ç†å‘˜

1. ç‚¹å‡»å·¦ä¾§ "Admin" è¡¨
2. æŸ¥çœ‹æ‰€æœ‰ç®¡ç†å‘˜è´¦æˆ·

### 3. åˆ›å»ºç®¡ç†å‘˜

1. ç‚¹å‡» "Add record"
2. å¡«å†™ï¼š
   - `username`: ç”¨æˆ·å
   - `password`: **å¿…é¡»æ˜¯åŠ å¯†åçš„å¯†ç **ï¼ˆè§ä¸‹æ–¹ï¼‰
3. ç‚¹å‡» "Save 1 change"

**é‡è¦ï¼š** å¯†ç å¿…é¡»å…ˆåŠ å¯†ï¼

### 4. åŠ å¯†å¯†ç 

ä½¿ç”¨ Node.js åŠ å¯†å¯†ç ï¼š

```bash
node -e "const bcrypt = require('bcryptjs'); console.log(bcrypt.hashSync('your-password', 10))"
```

æˆ–ä½¿ç”¨åœ¨çº¿å·¥å…·ï¼šhttps://bcrypt-generator.com/

### 5. åˆ é™¤ç®¡ç†å‘˜

1. é€‰æ‹©è¦åˆ é™¤çš„è®°å½•
2. ç‚¹å‡»åˆ é™¤å›¾æ ‡
3. ç¡®è®¤åˆ é™¤

---

## ä½¿ç”¨ SQL ç›´æ¥æ“ä½œ

### è¿æ¥æ•°æ®åº“

```bash
# Supabase
psql "postgresql://postgres:password@db.xxx.supabase.co:5432/postgres"

# Neon
psql "postgresql://user:pass@ep-xxx.neon.tech/neondb?sslmode=require"

# æœ¬åœ°
psql -U username -d game_leaderboard_admin
```

### æŸ¥çœ‹æ‰€æœ‰ç®¡ç†å‘˜

```sql
SELECT id, username, "createdAt", "updatedAt" 
FROM "Admin" 
ORDER BY "createdAt";
```

### åˆ›å»ºç®¡ç†å‘˜

```sql
-- æ³¨æ„ï¼šå¯†ç å¿…é¡»å…ˆåŠ å¯†ï¼
INSERT INTO "Admin" (id, username, password, "createdAt", "updatedAt")
VALUES (
  gen_random_uuid()::text,
  'newadmin',
  '$2a$10$encrypted_password_hash_here',
  NOW(),
  NOW()
);
```

### ä¿®æ”¹å¯†ç 

```sql
-- æ³¨æ„ï¼šå¯†ç å¿…é¡»å…ˆåŠ å¯†ï¼
UPDATE "Admin"
SET password = '$2a$10$new_encrypted_password_hash',
    "updatedAt" = NOW()
WHERE username = 'admin';
```

### åˆ é™¤ç®¡ç†å‘˜

```sql
DELETE FROM "Admin" WHERE username = 'oldadmin';
```

---

## å®‰å…¨å»ºè®®

### âœ… æ¨èåšæ³•

1. **ä½¿ç”¨å¼ºå¯†ç **
   - è‡³å°‘ 12 ä¸ªå­—ç¬¦
   - åŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹å·
   - ä¸ä½¿ç”¨å¸¸è§å¯†ç 

2. **å®šæœŸæ›´æ¢å¯†ç **
   ```bash
   npm run admin:password
   ```

3. **é™åˆ¶ç®¡ç†å‘˜æ•°é‡**
   - åªåˆ›å»ºå¿…è¦çš„ç®¡ç†å‘˜è´¦æˆ·
   - å®šæœŸå®¡æŸ¥ç®¡ç†å‘˜åˆ—è¡¨

4. **ç”Ÿäº§ç¯å¢ƒç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç **
   ```bash
   # é¦–æ¬¡éƒ¨ç½²åç«‹å³æ‰§è¡Œ
   npm run admin:password admin
   ```

5. **ä½¿ç”¨ç¯å¢ƒå˜é‡ä¿æŠ¤**
   - ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†ç 
   - ä½¿ç”¨ `.env` æ–‡ä»¶ï¼ˆä¸æäº¤åˆ° Gitï¼‰

### âŒ é¿å…åšæ³•

1. âŒ ä½¿ç”¨å¼±å¯†ç ï¼ˆå¦‚ `123456`, `admin123`ï¼‰
2. âŒ åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨é»˜è®¤è´¦æˆ·
3. âŒ å…±äº«ç®¡ç†å‘˜è´¦æˆ·
4. âŒ åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†ç 
5. âŒ ä¸åŠ å¯†ç›´æ¥å­˜å‚¨å¯†ç 

---

## å¯†ç åŠ å¯†è¯´æ˜

### ä¸ºä»€ä¹ˆéœ€è¦åŠ å¯†ï¼Ÿ

- ä¿æŠ¤ç”¨æˆ·éšç§
- é˜²æ­¢æ•°æ®åº“æ³„éœ²æ—¶å¯†ç è¢«ç›—
- ç¬¦åˆå®‰å…¨æœ€ä½³å®è·µ

### ä½¿ç”¨çš„åŠ å¯†æ–¹å¼

- **ç®—æ³•**: bcrypt
- **æˆæœ¬å› å­**: 10ï¼ˆå¹³è¡¡å®‰å…¨æ€§å’Œæ€§èƒ½ï¼‰
- **ç›å€¼**: è‡ªåŠ¨ç”Ÿæˆï¼ˆæ¯ä¸ªå¯†ç å”¯ä¸€ï¼‰

### åŠ å¯†ç¤ºä¾‹

```typescript
import bcrypt from 'bcryptjs'

// åŠ å¯†å¯†ç 
const password = 'mySecurePassword123'
const hashedPassword = await bcrypt.hash(password, 10)
// ç»“æœ: $2a$10$N9qo8uLOickgx2ZMRZoMyeIjZAgcfl7p92ldGxad68LJZdL17lhWy

// éªŒè¯å¯†ç 
const isValid = await bcrypt.compare('mySecurePassword123', hashedPassword)
// ç»“æœ: true
```

---

## å¸¸è§é—®é¢˜

### Q: å¿˜è®°ç®¡ç†å‘˜å¯†ç æ€ä¹ˆåŠï¼Ÿ

**A:** ä½¿ç”¨å¯†ç é‡ç½®å‘½ä»¤ï¼š

```bash
npm run admin:password admin
```

æˆ–ä½¿ç”¨ Prisma Studio ç›´æ¥ä¿®æ”¹ï¼ˆéœ€è¦å…ˆåŠ å¯†æ–°å¯†ç ï¼‰ã€‚

### Q: å¦‚ä½•åˆ›å»ºå¤šä¸ªç®¡ç†å‘˜ï¼Ÿ

**A:** å¤šæ¬¡è¿è¡Œåˆ›å»ºå‘½ä»¤ï¼š

```bash
npm run admin:create
# è¾“å…¥ç¬¬ä¸€ä¸ªç®¡ç†å‘˜ä¿¡æ¯

npm run admin:create
# è¾“å…¥ç¬¬äºŒä¸ªç®¡ç†å‘˜ä¿¡æ¯
```

### Q: é»˜è®¤ç®¡ç†å‘˜è´¦æˆ·å®‰å…¨å—ï¼Ÿ

**A:** ä¸å®‰å…¨ï¼é»˜è®¤è´¦æˆ·ï¼ˆadmin/admin123ï¼‰ä»…ç”¨äºå¼€å‘å’Œæµ‹è¯•ã€‚

**ç”Ÿäº§ç¯å¢ƒå¿…é¡»ï¼š**
1. ä¿®æ”¹é»˜è®¤å¯†ç ï¼š`npm run admin:password admin`
2. æˆ–åˆ é™¤é»˜è®¤è´¦æˆ·ï¼Œåˆ›å»ºæ–°çš„ï¼š`npm run admin:create`

### Q: å¦‚ä½•åˆ é™¤ç®¡ç†å‘˜ï¼Ÿ

**A:** ä½¿ç”¨ Prisma Studioï¼š

```bash
npx prisma studio
# æ‰“å¼€ Admin è¡¨
# é€‰æ‹©è¦åˆ é™¤çš„è®°å½•
# ç‚¹å‡»åˆ é™¤
```

æˆ–ä½¿ç”¨ SQLï¼š
```sql
DELETE FROM "Admin" WHERE username = 'username';
```

### Q: å¯†ç åŠ å¯†å¤±è´¥ï¼Ÿ

**A:** ç¡®ä¿å®‰è£…äº† bcryptjsï¼š

```bash
npm install bcryptjs
npm install -D @types/bcryptjs
```

### Q: å¦‚ä½•æ‰¹é‡åˆ›å»ºç®¡ç†å‘˜ï¼Ÿ

**A:** åˆ›å»ºè‡ªå®šä¹‰è„šæœ¬æˆ–ä¿®æ”¹ `prisma/seed.ts`ï¼š

```typescript
const admins = [
  { username: 'admin1', password: 'password1' },
  { username: 'admin2', password: 'password2' },
]

for (const { username, password } of admins) {
  const hashedPassword = await bcrypt.hash(password, 10)
  await prisma.admin.upsert({
    where: { username },
    update: {},
    create: { username, password: hashedPassword },
  })
}
```

---

## å¿«é€Ÿå‚è€ƒ

```bash
# åˆ›å»ºç®¡ç†å‘˜
npm run admin:create

# åˆ—å‡ºç®¡ç†å‘˜
npm run admin:list

# ä¿®æ”¹å¯†ç 
npm run admin:password

# æŸ¥çœ‹æ•°æ®åº“
npx prisma studio

# åˆ›å»ºé»˜è®¤ç®¡ç†å‘˜ï¼ˆadmin/admin123ï¼‰
npm run db:seed

# é‡ç½®æ•°æ®åº“ï¼ˆåˆ é™¤æ‰€æœ‰æ•°æ®ï¼‰
npm run db:reset
```

---

## ç›¸å…³æ–‡æ¡£

- [DATABASE_SETUP.md](./DATABASE_SETUP.md) - æ•°æ®åº“è®¾ç½®
- [QUICK_START.md](./QUICK_START.md) - å¿«é€Ÿå¯åŠ¨
- [SECURITY.md](./SECURITY.md) - å®‰å…¨æŒ‡å—
- [Prisma æ–‡æ¡£](https://www.prisma.io/docs)
